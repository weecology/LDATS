% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/TS.R
\name{TS}
\alias{TS}
\alias{run_TS}
\alias{TS_call}
\alias{TS_msg}
\alias{prepare_TS}
\alias{package_TS}
\alias{select_TS}
\alias{measure_TS}
\alias{TS_control}
\title{Conduct a Bayesian compositional Time Series analysis}
\usage{
TS(LDAs, data, formulas = ~1, nchangepoints = 0, timename = "time",
  weights = NULL, control = list())

run_TS(TSs)

TS_call(TS)

TS_msg(TS)

prepare_TS(LDAs, data, formulas = ~1, nchangepoints = 0,
  timename = "time", weights = NULL, control = list())

package_TS(TSs)

select_TS(TSs)

measure_TS(TSs)

TS_control(model = sequential_TS, model_args = list(control =
  sequential_TS_control()), response = multinom_TS,
  response_args = list(control = multinom_TS_control()),
  method = ldats_classic, method_args = list(control =
  ldats_classic_control()), summary_prob = 0.95, measurer = AIC,
  measurer_args = list(NULL), selector = which.min,
  selector_args = list(NULL), soften = TRUE, quiet = FALSE, ...)
}
\arguments{
\item{data}{\code{data.frame} including [1] the time variable (indicated 
in \code{timename}), [2] the predictor variables (required by
\code{formula}) and [3], the compositional response variable (indicated
in \code{formula}). \cr \cr
Note that the response variables should be formatted as a 
\code{data.frame} object named as indicated by the \code{response} entry
in the \code{control} list, such as \code{gamma} for a standard TS 
analysis on LDA output.}

\item{formulas}{Vector of \code{\link[stats]{formula}}(s) defining the 
regression between the change points. Any predictor variable included 
must also be a column in \code{data} and any (compositional) response 
variable must be a set of columns in \code{data}. \cr
Each element (formula) in the vector is evaluated for each number of 
change points and each LDA model.}

\item{nchangepoints}{\code{integer}-conformable vector corresponding to the 
number of change points to include in the models. 0 is valid (corresponds
to no change points, so a singular time series model) and the current 
implementation can reasonably include up to 6 change points. The 
number of change points is used to dictate the segmentation of the 
time series into chunks fit with separate models dictated by 
\code{formula}. \cr
Each element in the vector is the number of change points 
used to segment the data for each formula (entry in \code{formulas}) 
component of the TS model, for each selected LDA model.}

\item{timename}{\code{character} element indicating the time variable
used in the time series. Defaults to \code{"time"}. The variable must be
integer-conformable or a \code{Date}. If the variable named
is a \code{Date}, the input is converted to an integer, resulting in the
timestep being 1 day, which is often not desired behavior.}

\item{weights}{Optional class \code{numeric} vector of weights for each 
document. Defaults to \code{NULL}, translating to an equal weight for
each document. When using \code{\link{TS_call}} in a standard LDATS 
analysis, it is advisable to weight the documents by their total size,
as the result of, e.g., \code{\link[topicmodels]{LDA}} is a matrix of 
proportions, which does not account for size differences among documents.
For most models, a scaling of the weights (so that the average is 1) is
most appropriate, and this is accomplished using \code{document_weights}.}

\item{control}{A \code{list} of parameters to control the fitting of the
Time Series model. Values not input assume defaults set by 
\code{\link{TS_control}}.}

\item{TS, TSs}{time series model \code{list} (\code{TS}) or a \code{list} 
of many time series model \code{list}s (\code{TSs}).}

\item{response}{\code{character} element indicating the response variable 
used in the time series. \cr \cr
Must have a corresponding \code{<response>_TS} function.}

\item{response_args}{\code{list} of (named) arguments to be used in 
\code{response} via \code{\link{do.call}}. 
\cr \cr
Could be managed via a \code{<reponse>_TS_control} function like
\code{\link{multinom_TS_control}}.}

\item{method}{\code{function} used to drive the sampler of the TS
models; \code{method} defines and operates the computational procedure.
\cr \cr
Current pre-built options include \code{\link{ldats_classic}}.}

\item{method_args}{\code{list} of (named) arguments to be used in 
\code{method} via \code{\link{do.call}}. 
\cr \cr
Could be managed via a \code{<method>_control} function like
\code{\link{ldats_classic_control}}.}

\item{summary_prob}{Probability used for summarizing the posterior 
distributions (via the highest posterior density interval, see
\code{\link[coda]{HPDinterval}}).}

\item{measurer}{\code{function} used in evaluation of the TS
models; \code{measurer} creates a value for each model.}

\item{measurer_args}{\code{list} of (named) arguments to be used in 
\code{measurer} via \code{\link{do.call}}.}

\item{selector}{\code{function} usde in evaluation of the TS
models; \code{selector} operates on the values to choose the models.}

\item{selector_args}{\code{list} of (named) arguments to be used in 
\code{selector} via \code{\link{do.call}}.}

\item{soften}{\code{logical} indicator of whether the model should error 
softly or if errors should trigger a full-stop to the pipeline.}

\item{quiet}{\code{logical} indicator of whether the model should run 
quietly (if \code{FALSE}, a progress bar and notifications are printed).}

\item{...}{Not passed along to the output, rather included to allow for
automated removal of unneeded controls.}

\item{selected_TSs}{\code{list} of selected time series model \code{list}s.}
}
\value{
\code{TS},\code{pacakage_TS}: class \code{TS_set} \code{list} of both 
    selected and all results from \code{\link{TS_call}} applied for 
    each model on each LDA model input as well as the control \code{list} 
    used to fit the model. \cr \cr
  \code{prepare_TS}: \code{list} of \code{list}s, each of which is a
    preliminary model object for a Time Series model fit. \cr \cr
  \code{TS_control}: \code{list} of named control elements for
    model fitting.
  \code{measure_TS}: \code{vector} of values corresponding to the model
    evaluations. \cr \cr
  \code{select_TS}: \code{list} of selected models' \code{list}s. \cr \cr
  \code{run_TS}: \code{TS_set} \code{list} of model results from all
    runs of a \code{<model>} function, such as 
    \code{\link{topicmodels_TS}}. \cr \cr
  \code{TS_call}: \code{TS} \code{list} of model results from a single
    run of a \code{<model>} function, such as 
    \code{\link{sequential_TS}}. \cr \cr
  \code{TS_msg}: a message is produced.
}
\description{
Analyze compositional Time Series models using Bayesian
  sampling methods. \cr \cr
  \code{TS} is the main interface function for the LDATS application
    of Bayesian change point Time Series analyses (Christensen 
    \emph{et al.} 2018). \cr \cr
  \code{prepare_TS} pre-prepares the TS model objects for simpler 
    use within the subfunctions. \cr \cr
  \code{TS_control} defines and creates the control \code{list} for the TS
    model running. \cr \cr
  \code{run_TS} runs (via \code{\link{TS_call}}) all TS models
    as set up by \code{prep_TS_models}. \cr \cr
  \code{TS_call} runs (via \code{\link{do.call}}) a single TS model
    as set up by \code{prep_TS_models}. \cr \cr
  \code{TS_msg} produces a model-running message if desired. \cr \cr
  \code{measure_TS} determines the fit value used to select among the 
    models. \cr \cr
  \code{select_TS} chooses the best model(s) of interest based on their
    measured values and the selector function. \cr \cr
  \code{package_TS} sets the class and names the elements of the results
    \code{list} from \code{\link{TS_call}} applied to the 
    combination of TS models requested for the LDA model(s) input.
}
\details{
For a (potentially subset) dataset consisting of proportions of
  topics across multiple documents in a corpus 
  \enumerate{
    \item Conduct multiple compositional Bayesian TS models 
      (e.g., changepoint softmax regression; Ripley 1996, Venables 
      and Ripley 2002, Western and Kleykamp 2004, Bishop 2006, Ruggieri 
      2013) via a generalized linear modeling approach (McCullagh and 
      Nelder 1989) and using parallel tempering Markov Chain Monte Carlo
     (ptMCMC) methods (Earl and Deem 2005),
    \item Select from the TS model results to pick those used to summarize
      the whole model, and
    \item Package the results.
  }
}
\references{
Bishop, C. M. 2006. \emph{Pattern Recognition and Machine Learning}. 
   Springer, New York, NY, USA.

  Christensen, E., D. J. Harris, and S. K. M. Ernest. 2018.
  Long-term community change through multiple rapid transitions in a 
  desert rodent community. \emph{Ecology} \strong{99}:1523-1529. 
  \href{https://doi.org/10.1002/ecy.2373}{link}.

  Earl, D. J. and M. W. Deem. 2005. Parallel tempering: theory, 
  applications, and new perspectives. \emph{Physical Chemistry Chemical 
  Physics} \strong{7}: 3910-3916.
  \href{https://doi.org/10.1039/B509983H}{link}.

  McCullagh, P. and J. A. Nelder. 1989. \emph{Generalized Linear Models}.
  2nd Edition. Chapman and Hall, New York, NY, USA.

  Ripley, B. D. 1996. \emph{Pattern Recognition and Neural Networks}. 
  Cambridge University Press, Cambridge, UK.

  Ruggieri, E. 2013. A Bayesian approach to detecting change points in 
  climactic records. \emph{International Journal of Climatology}
  \strong{33}:520-528.
  \href{https://doi.org/10.1002/joc.3447}{link}.

  Venables, W. N. and B. D. Ripley. 2002. \emph{Modern and Applied
  Statistics with S}. Fourth Edition. Springer, New York, NY, USA.

  Western, B. and M. Kleykamp. 2004. A Bayesian change point model for 
  historical time series analysis. \emph{Political Analysis}
  \strong{12}:354-374.
  \href{https://doi.org/10.1093/pan/mph023}{link}.
}
